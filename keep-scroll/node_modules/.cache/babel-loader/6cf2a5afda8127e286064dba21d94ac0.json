{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect, useLayoutEffect, useMemo } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nexport default function useKeepPositionScroll() {\n  _s();\n\n  let location = useLocation();\n  const [scrollTop, setScrollTop] = useState(0);\n  const scrollPosition = useMemo(() => {\n    return JSON.parse(sessionStorage.getItem(\"scroll-position\")) || [];\n  }, []);\n\n  const windowScrollTop = () => {\n    const position = window.pageYOffset; // setScrollTop(position);\n\n    sessionStorage.setItem(\"scroll-position\", JSON.stringify([...scrollPosition, {\n      pathname: location.pathname,\n      position\n    }]));\n  }; // useLayoutEffect(() => {\n  // if (!scrollPosition.length) return;\n  //   const positionByPathname =\n  //     scrollPosition.find((v) => v.pathname === location.pathname)?.position ||\n  //     0;\n  //   window.scrollTo(0, positionByPathname);\n  // }, [location.pathname, scrollPosition]);\n\n\n  useEffect(() => {\n    let newScrollPosition = [];\n    const id = scrollPosition.findIndex(v => v.pathname === location.pathname);\n\n    if (id !== -1) {\n      window.scrollTo(0, scrollPosition[id].position);\n      newScrollPosition = [...scrollPosition];\n      newScrollPosition.splice(id, 1, {\n        pathname: location.pathname,\n        position: scrollPosition[id].position\n      });\n      sessionStorage.setItem(\"scroll-position\", JSON.stringify(newScrollPosition));\n      return;\n    }\n\n    newScrollPosition = [...scrollPosition, {\n      pathname: location.pathname,\n      position: 0\n    }];\n    sessionStorage.setItem(\"scroll-position\", JSON.stringify(newScrollPosition));\n    window.addEventListener(\"scroll\", windowScrollTop);\n    return () => window.removeEventListener(\"scroll\", windowScrollTop);\n  }, []); // useEffect(() => {}, [location.pathname, scrollTop, scrollPosition]);\n\n  return location;\n}\n\n_s(useKeepPositionScroll, \"mQbTnGJhqfeOywUxUgqjUS4ADTk=\", false, function () {\n  return [useLocation];\n});","map":{"version":3,"sources":["C:/Users/Admin/Desktop/github/react-func/keep-scroll/src/hooks/useKeepPositionScroll.js"],"names":["useState","useEffect","useLayoutEffect","useMemo","useLocation","useKeepPositionScroll","location","scrollTop","setScrollTop","scrollPosition","JSON","parse","sessionStorage","getItem","windowScrollTop","position","window","pageYOffset","setItem","stringify","pathname","newScrollPosition","id","findIndex","v","scrollTo","splice","addEventListener","removeEventListener"],"mappings":";;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,eAA9B,EAA+CC,OAA/C,QAA8D,OAA9D;AACA,SAASC,WAAT,QAA4B,kBAA5B;AAEA,eAAe,SAASC,qBAAT,GAAiC;AAAA;;AAC9C,MAAIC,QAAQ,GAAGF,WAAW,EAA1B;AACA,QAAM,CAACG,SAAD,EAAYC,YAAZ,IAA4BR,QAAQ,CAAC,CAAD,CAA1C;AACA,QAAMS,cAAc,GAAGN,OAAO,CAAC,MAAM;AACnC,WAAOO,IAAI,CAACC,KAAL,CAAWC,cAAc,CAACC,OAAf,CAAuB,iBAAvB,CAAX,KAAyD,EAAhE;AACD,GAF6B,EAE3B,EAF2B,CAA9B;;AAIA,QAAMC,eAAe,GAAG,MAAM;AAC5B,UAAMC,QAAQ,GAAGC,MAAM,CAACC,WAAxB,CAD4B,CAE5B;;AAEAL,IAAAA,cAAc,CAACM,OAAf,CACE,iBADF,EAEER,IAAI,CAACS,SAAL,CAAe,CACb,GAAGV,cADU,EAEb;AACEW,MAAAA,QAAQ,EAAEd,QAAQ,CAACc,QADrB;AAEEL,MAAAA;AAFF,KAFa,CAAf,CAFF;AAUD,GAdD,CAP8C,CAuB9C;AACE;AACF;AACA;AACA;AAEA;AACA;;;AAEAd,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIoB,iBAAiB,GAAG,EAAxB;AAEA,UAAMC,EAAE,GAAGb,cAAc,CAACc,SAAf,CACRC,CAAD,IAAOA,CAAC,CAACJ,QAAF,KAAed,QAAQ,CAACc,QADtB,CAAX;;AAIA,QAAIE,EAAE,KAAK,CAAC,CAAZ,EAAe;AACbN,MAAAA,MAAM,CAACS,QAAP,CAAgB,CAAhB,EAAmBhB,cAAc,CAACa,EAAD,CAAd,CAAmBP,QAAtC;AAEAM,MAAAA,iBAAiB,GAAG,CAAC,GAAGZ,cAAJ,CAApB;AACAY,MAAAA,iBAAiB,CAACK,MAAlB,CAAyBJ,EAAzB,EAA6B,CAA7B,EAAgC;AAC9BF,QAAAA,QAAQ,EAAEd,QAAQ,CAACc,QADW;AAE9BL,QAAAA,QAAQ,EAAEN,cAAc,CAACa,EAAD,CAAd,CAAmBP;AAFC,OAAhC;AAKAH,MAAAA,cAAc,CAACM,OAAf,CACE,iBADF,EAEER,IAAI,CAACS,SAAL,CAAeE,iBAAf,CAFF;AAKA;AACD;;AAEDA,IAAAA,iBAAiB,GAAG,CAClB,GAAGZ,cADe,EAElB;AACEW,MAAAA,QAAQ,EAAEd,QAAQ,CAACc,QADrB;AAEEL,MAAAA,QAAQ,EAAE;AAFZ,KAFkB,CAApB;AAQAH,IAAAA,cAAc,CAACM,OAAf,CACE,iBADF,EAEER,IAAI,CAACS,SAAL,CAAeE,iBAAf,CAFF;AAKAL,IAAAA,MAAM,CAACW,gBAAP,CAAwB,QAAxB,EAAkCb,eAAlC;AAEA,WAAO,MAAME,MAAM,CAACY,mBAAP,CAA2B,QAA3B,EAAqCd,eAArC,CAAb;AACD,GAxCQ,EAwCN,EAxCM,CAAT,CAhC8C,CA0E9C;;AAEA,SAAOR,QAAP;AACD;;GA7EuBD,qB;UACPD,W","sourcesContent":["import { useState, useEffect, useLayoutEffect, useMemo } from \"react\";\nimport { useLocation } from \"react-router-dom\";\n\nexport default function useKeepPositionScroll() {\n  let location = useLocation();\n  const [scrollTop, setScrollTop] = useState(0);\n  const scrollPosition = useMemo(() => {\n    return JSON.parse(sessionStorage.getItem(\"scroll-position\")) || [];\n  }, []);\n\n  const windowScrollTop = () => {\n    const position = window.pageYOffset;\n    // setScrollTop(position);\n\n    sessionStorage.setItem(\n      \"scroll-position\",\n      JSON.stringify([\n        ...scrollPosition,\n        {\n          pathname: location.pathname,\n          position,\n        },\n      ])\n    );\n  };\n\n  // useLayoutEffect(() => {\n    // if (!scrollPosition.length) return;\n  //   const positionByPathname =\n  //     scrollPosition.find((v) => v.pathname === location.pathname)?.position ||\n  //     0;\n\n  //   window.scrollTo(0, positionByPathname);\n  // }, [location.pathname, scrollPosition]);\n\n  useEffect(() => {\n    let newScrollPosition = [];\n\n    const id = scrollPosition.findIndex(\n      (v) => v.pathname === location.pathname\n    );\n\n    if (id !== -1) {\n      window.scrollTo(0, scrollPosition[id].position);\n\n      newScrollPosition = [...scrollPosition];\n      newScrollPosition.splice(id, 1, {\n        pathname: location.pathname,\n        position: scrollPosition[id].position,\n      });\n\n      sessionStorage.setItem(\n        \"scroll-position\",\n        JSON.stringify(newScrollPosition)\n      );\n\n      return;\n    }\n\n    newScrollPosition = [\n      ...scrollPosition,\n      {\n        pathname: location.pathname,\n        position: 0,\n      },\n    ];\n\n    sessionStorage.setItem(\n      \"scroll-position\",\n      JSON.stringify(newScrollPosition)\n    );\n\n    window.addEventListener(\"scroll\", windowScrollTop);\n\n    return () => window.removeEventListener(\"scroll\", windowScrollTop);\n  }, []);\n\n  // useEffect(() => {}, [location.pathname, scrollTop, scrollPosition]);\n\n  return location;\n}\n"]},"metadata":{},"sourceType":"module"}